<!DOCTYPE html>
<html>
<head>
	<title>Inmar CMS</title>

	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="angular.js"></script>
    <style type="text/css">
    	
      .create_group 
      {
        position: fixed;
        top:80%;
        left:92%;
      }
      .group_section .panel-default
      {
        float: left;
        margin-right: 2%;
        width: 25%;
      }
      .group_section .panel-default a{
        float: right;
        //display: inline-block;
      }
    </style>
    <script type="text/javascript">
       var app=angular.module("myapp",[]);
       app.service("sendgrpdet",function($http){
            this.send_details=function(v){
                
                var request = $http({ 
                     method: "post", 
                     url: "creategrp.php", 
                     headers:{'content-type':'application/x-www-form-urlencoded'}, 
                     transformRequest: function(obj) {
                                                  var str = [];
                                                  for(var p in obj)
                                                  {
                                                        //console.log(p);
                                                        str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
                                                  }                                                      
                                                  //alert(str.join("&"));
                                                    return str.join("&");
                                            },
                     data: { 
                         
                         gid: v.gid,
                         gname:v.gname,
                         owner_email:'mouni@inmar.com'
                     } 
                 }); 
  
                 // Store the data-dump of the FORM scope. 
                 request.success( 
                     function( data ) { 
  
                         //v.message = data; 
                         //alert(JSON.stringify(data));
                         //v.collect=data;
                         alert("Group created successfully");
                         v.onpageload();
                     } 
                 ); 


            }
       });
       app.service("collectgrpinfo",function($http){
             this.getgroupinfo=function(v){

                  $http.get("grpsend.php")
                    .then(function(response) {
                        v.collect = response.data;
                        //alert(JSON.stringify(v.collect));
                    });
             }
       });
       app.controller("app_con",function($scope,sendgrpdet,collectgrpinfo){
            $scope.gname="";
            $scope.gid="";
            $scope.collect="";
            $scope.send=function(){
               //alert("hai");
               sendgrpdet.send_details($scope);
               console.log($scope.collect);
            }
            $scope.onpageload=function(){
              //alert("i am loaded");
              collectgrpinfo.getgroupinfo($scope);
            }
            $scope.getcontact=function(groupid){
                console.log(groupid);
            }
       });
    </script>
</head>
<body ng-app="myapp" ng-controller="app_con" ng-init="onpageload()">
   
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="#">WebSiteName</a>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class="glyphicon glyphicon-search"></span></a></li>
      </ul>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li class="active"><a id="showContacts">Contacts</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" id="showGroups">Groups
            <span class="caret"></span>
          </a>
          <ul class="dropdown-menu">
            <li><a href="#">Group1</a></li>
            <li><a href="#">Group2</a></li>
            <li><a href="#">Group3</a></li>
          </ul>
        </li>
        <li>
        	<a class="dropdown-toggle" data-toggle="dropdown" id="sortby">SortBy
        	 <span class="caret"></span>
        	</a>
        	<ul class="dropdown-menu">
        		<li><a href="#">Name</a></li>
        		<li><a href="#">email</a></li>
        	</ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class="glyphicon glyphicon-log-out"></span> LogOut</a></li>
      </ul>
    </div>
      
  </div>
</nav>
<div class="create_group">
   <a href="#" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal"><img src="i4.png" width="65" height="50"></a>   
</div>
<div class="container-fluid">
       <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Create Group</h4>
        </div>
        <div class="modal-body">
            <div class="form-group">
              <label >Group Name:</label>
              <input type="text" class="form-control" id="gname" ng-model="gname">
            </div>
            <div class="form-group">
              <label >Group Id:</label>
              <input type="text" class="form-control" id="gid" ng-model="gid">
            </div>
        </div>
        <div class="modal-footer">
          <buttonype="button" class="btn btn-default" data-dismiss="modal" ng-click="send()">Create</button>
        </div>
      </div>
      
    </div>
  </div>
</div>



<!--<div class="container-fluid group_section">
    <div class="row">
         <div class="col-sm-12 col-xs-12" result_header" id="result_holder">
          <div ng-hide='contact_module'>
            <table class="table table-striped">
              <tr>
                <th>Name</th>
                <th>Phone</th>
                <th>Email</th>
                <th>Delete</th>
                <th>Edit</th>
              </tr>
              <tr ng-repeat="x in collect_contact_inf">
              <td>{{x.name}}</td>
              <td>{{x.phno}}</td>
              <td>{{x.cemail}}</td>
              <td><a href="#" ng-click="delete_contact(x.g_id,x.cemail,x.uemail)">delete</a></td>
                <td><a href="#" ng-click="edit_contact(x.name,x.phno,x.uemail,x.cemail,x.g_id)">Edit</a></td>
              </tr>
            </table>
          </div>



              <div ng-repeat="x in collect|orderBy:groupname" name="group_module" ng-hide='group_module'>
                    <div class="panel panel-default" >

                      <div class="panel-heading">{{x.groupname}}<a class="btn"><img src="i4.png" width="20" height="20"></a></div>
                      <div class="panel-body"><a href="#" ng-click="getcontact(x.groupid)">view more....</a></div>
                    </div>
              </div>
         </div>
    </div>
</div>-->



<div class="container-fluid group_section">
    <div class="row">
         <div class="col-sm-12 col-xs-12">
              <div ng-repeat="x in collect|orderBy:groupname" >
                    <div class="panel panel-default" >
                      <div class="panel-heading">{{x.groupname}}<a class="btn"><img src="i4.png" width="20" height="20"></a></div>
                      <div class="panel-body"><a href="#" ng-click="getcontact(x.groupid)">view more....</a></div>
                    </div>
              </div>
         </div>
    </div>
</div>
</body>
</html>